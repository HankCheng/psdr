<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Package that generates power spectral density plots using time series data • psdr</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.4.1/jquery.min.js" integrity="sha256-CSXorXvZcTkaix6Yvo6HppcZGetbYMGWSFlBw8HfCJo=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="bootstrap-toc.css">
<script src="bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="pkgdown.css" rel="stylesheet">
<script src="pkgdown.js"></script><meta property="og:title" content="Package that generates power spectral density plots using time series data">
<meta property="og:description" content="To be added.">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body data-spy="scroll" data-target="#toc">
    

    <div class="container template-home">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="index.html">psdr</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">0.0.0.9000</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="articles/examples_with_output.html">examples_with_output</a>
    </li>
  </ul>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right"></ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="contents col-md-9">

<div id="overview" class="section level2">
<h2 class="hasAnchor">
<a href="#overview" class="anchor"></a>Overview</h2>
<p>Author: Yong-Han Hank Cheng</p>
<p>This package allows you to generate and compare power spectral density (PSD) plots given timeseries data.</p>
</div>
<div id="installation" class="section level2">
<h2 class="hasAnchor">
<a href="#installation" class="anchor"></a>Installation</h2>
<div class="sourceCode" id="cb1"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Install the package from GitHub</span>
<span class="fu">devtools</span><span class="fu">::</span><span class="fu"><a href="https://devtools.r-lib.org//reference/remote-reexports.html" class="external-link">install_github</a></span><span class="op">(</span><span class="st">"yhhc2/psdr"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co"># Load package</span>
<span class="kw"><a href="https://rdrr.io/r/base/library.html" class="external-link">library</a></span><span class="op">(</span><span class="st">"psdr"</span><span class="op">)</span></code></pre></div>
</div>
<div id="usage" class="section level2">
<h2 class="hasAnchor">
<a href="#usage" class="anchor"></a>Usage</h2>
<p>Visit the package’s website for function reference: <a href="https://yhhc2.github.io/psdr/" class="external-link uri">https://yhhc2.github.io/psdr/</a></p>
</div>
<div id="examples" class="section level2">
<h2 class="hasAnchor">
<a href="#examples" class="anchor"></a>Examples</h2>
<p>All functions with example code is run in this section. The functions are listed below in alphabetical order with example code to illustrate how each function should be used. The example code should be very similar to the example code in the function reference.</p>
<p>To see detailed descriptions for each function, please visit the package’s website.</p>
<div id="automatedcompositeplotting" class="section level3">
<h3 class="hasAnchor">
<a href="#automatedcompositeplotting" class="anchor"></a>AutomatedCompositePlotting()</h3>
<div class="sourceCode" id="cb3"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#I want to create a plot that shows two curves:</span>
<span class="co">#1. Composite of time series signals 1, 2, and 3.</span>
<span class="co">#2. Composite of time series signals 3 and 4.</span>

<span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>, <span class="va">S4.data.frame</span><span class="op">)</span>

<span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co">#Gets the composite of the third and fourth signal</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>


<span class="co">#Timeseries-----------------------------------------------------------------</span>

<span class="va">timeseries.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">999</span>,
                           x_increment <span class="op">=</span> <span class="fl">1</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Time"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"Original units"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="cn">NULL</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"TimeSeries"</span>,
                           sampling_frequency <span class="op">=</span> <span class="cn">NULL</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb4"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1"></a><span class="co">## [1] 1</span></span>
<span id="cb4-2"><a href="#cb4-2"></a><span class="co">## [1] 2</span></span>
<span id="cb4-3"><a href="#cb4-3"></a><span class="co">## [1] 3</span></span>
<span id="cb4-4"><a href="#cb4-4"></a><span class="co">## [1] 1</span></span>
<span id="cb4-5"><a href="#cb4-5"></a><span class="co">## [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.timeseries</span> <span class="op">&lt;-</span> <span class="va">timeseries.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot. Will see the 1+2+3 curve as a flat line. The 3+4 curve will only have 2 Hz.</span>
<span class="co">#dev.new()</span>
<span class="va">ggplot.obj.timeseries</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-3-1.png"><!-- --></p>
<div class="sourceCode" id="cb6"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#PSD-------------------------------------------------------------------------</span>

<span class="co">#Note that the PSDs are not generated directly from the "Signal 1 + 2 + 3" and</span>
<span class="co">#the "Signal 3 + 4" time series. Instead, PSDs are generated individually</span>
<span class="co">#for signals 1, 2, 3, and 4, and then then are summed together. </span>

<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">50</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb7"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1"></a><span class="co">## [1] 1</span></span>
<span id="cb7-2"><a href="#cb7-2"></a><span class="co">## [1] 2</span></span>
<span id="cb7-3"><a href="#cb7-3"></a><span class="co">## [1] 3</span></span>
<span id="cb7-4"><a href="#cb7-4"></a><span class="co">## [1] 1</span></span>
<span id="cb7-5"><a href="#cb7-5"></a><span class="co">## [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should be</span>
<span class="co">#stronger in both cases because more signals have this frequency (even if amp is negative).</span>
<span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span>
<span class="co">#be present for 2 Hz signal.</span>
<span class="co">#dev.new()</span>
<span class="va">ggplot.obj.PSD</span></code></pre></div>
<div class="sourceCode" id="cb9"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1"></a><span class="co">## Warning: Removed 5 row(s) containing missing values (geom_path).</span></span>
<span id="cb9-2"><a href="#cb9-2"></a></span>
<span id="cb9-3"><a href="#cb9-3"></a><span class="co">## Warning: Removed 5 row(s) containing missing values (geom_path).</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-3-2.png"><!-- --></p>
<div class="sourceCode" id="cb10"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="co">#PSD Zoomed in---------------------------------------------------------------</span>

 <span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                            name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                            x_start <span class="op">=</span> <span class="fl">0</span>,
                            x_end <span class="op">=</span> <span class="fl">5</span>,
                            x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                            level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                            level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                            level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                            level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                            plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                            plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                            plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                            combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                            TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                            sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb11"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1"></a><span class="co">## [1] 1</span></span>
<span id="cb11-2"><a href="#cb11-2"></a><span class="co">## [1] 2</span></span>
<span id="cb11-3"><a href="#cb11-3"></a><span class="co">## [1] 3</span></span>
<span id="cb11-4"><a href="#cb11-4"></a><span class="co">## [1] 1</span></span>
<span id="cb11-5"><a href="#cb11-5"></a><span class="co">## [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb12"><pre class="downlit sourceCode r">
<code class="sourceCode R"> <span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

 <span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should be</span>
 <span class="co">#stronger in both cases because more signals have this frequency (even if amp is negative).</span>
 <span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span>
 <span class="co">#be present for 2 Hz signal.</span>
 <span class="co">#dev.new()</span>
 <span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-3-3.png"><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#LogPSD-------------------------------------------------------------------------</span>

<span class="va">LogPSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">50</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"log((Original units)^2/Hz)"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="cn">NULL</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"LogPSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb14"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb14-1"><a href="#cb14-1"></a><span class="co">## [1] 1</span></span>
<span id="cb14-2"><a href="#cb14-2"></a><span class="co">## [1] 2</span></span>
<span id="cb14-3"><a href="#cb14-3"></a><span class="co">## [1] 3</span></span>
<span id="cb14-4"><a href="#cb14-4"></a><span class="co">## [1] 1</span></span>
<span id="cb14-5"><a href="#cb14-5"></a><span class="co">## [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb15"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.LogPSD</span> <span class="op">&lt;-</span> <span class="va">LogPSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot. For both plots, two peaks will be present, 1 Hz and 2 Hz. 1 Hz should</span>
<span class="co">#be stronger in both cases because more signals have this frequency (even if amp is negative).</span>
<span class="co">#Error envelope is specified for the second (red) curve. Envelope should only</span>
<span class="co">#be present for 1 Hz signal.</span>
<span class="co">#dev.new()</span>
<span class="va">ggplot.obj.LogPSD</span></code></pre></div>
<div class="sourceCode" id="cb16"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb16-1"><a href="#cb16-1"></a><span class="co">## Warning: Removed 5 row(s) containing missing values (geom_path).</span></span>
<span id="cb16-2"><a href="#cb16-2"></a></span>
<span id="cb16-3"><a href="#cb16-3"></a><span class="co">## Warning: Removed 5 row(s) containing missing values (geom_path).</span></span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-3-4.png"><!-- --></p>
</div>
<div id="countwindows" class="section level3">
<h3 class="hasAnchor">
<a href="#countwindows" class="anchor"></a>CountWindows()</h3>
<div class="sourceCode" id="cb17"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example using a dataframe with 5 homogeneous windows.</span>

<span class="co">#Windows are homogeneous if looking at col.two and col.three values.</span>
<span class="va">window.name.column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>

<span class="va">multi.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">window.name.column</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="va">list.of.homogeneous.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetHomogeneousWindows.html">GetHomogeneousWindows</a></span><span class="op">(</span><span class="va">multi.window.data</span>,
<span class="st">"window.name.column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb18"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb18-1"><a href="#cb18-1"></a><span class="co">## [1] 1</span></span>
<span id="cb18-2"><a href="#cb18-2"></a><span class="co">## [1] 2</span></span>
<span id="cb18-3"><a href="#cb18-3"></a><span class="co">## [1] 3</span></span>
<span id="cb18-4"><a href="#cb18-4"></a><span class="co">## [1] 4</span></span>
<span id="cb18-5"><a href="#cb18-5"></a><span class="co">## [1] 5</span></span></code></pre></div>
<div class="sourceCode" id="cb19"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">matrix</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/CountWindows.html">CountWindows</a></span><span class="op">(</span><span class="va">list.of.homogeneous.windows</span>, <span class="st">"col.two"</span>, <span class="st">"col.three"</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span>, <span class="st">"3"</span><span class="op">)</span><span class="op">)</span>

<span class="va">matrix</span></code></pre></div>
<div class="sourceCode" id="cb20"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb20-1"><a href="#cb20-1"></a><span class="co">##   1 2 3</span></span>
<span id="cb20-2"><a href="#cb20-2"></a><span class="co">## a 2 1 1</span></span>
<span id="cb20-3"><a href="#cb20-3"></a><span class="co">## b 1 0 0</span></span></code></pre></div>
</div>
<div id="findhomogeneouswindows" class="section level3">
<h3 class="hasAnchor">
<a href="#findhomogeneouswindows" class="anchor"></a>FindHomogeneousWindows()</h3>
<div class="sourceCode" id="cb21"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">col.one</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span>, <span class="fl">4</span>, <span class="fl">5</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span><span class="op">)</span>

<span class="va">single.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">col.one</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="co">#Example of inhomogeneous window if looking at col.one and col.two because</span>
<span class="co">#col.one does not only have a single unique value.</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/FindHomogeneousWindows.html">FindHomogeneousWindows</a></span><span class="op">(</span><span class="va">single.window.data</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col.one"</span>, <span class="st">"col.two"</span><span class="op">)</span><span class="op">)</span>

<span class="va">result</span></code></pre></div>
<div class="sourceCode" id="cb22"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb22-1"><a href="#cb22-1"></a><span class="co">## [1] FALSE</span></span></code></pre></div>
<div class="sourceCode" id="cb23"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example of homogeneous window if looking at col.two and col.three because</span>
<span class="co">#col.two and col.three both only have a single unique value.</span>
<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/FindHomogeneousWindows.html">FindHomogeneousWindows</a></span><span class="op">(</span><span class="va">single.window.data</span> , <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span>

<span class="va">result</span></code></pre></div>
<div class="sourceCode" id="cb24"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb24-1"><a href="#cb24-1"></a><span class="co">## [1] TRUE</span></span></code></pre></div>
</div>
<div id="gethomogeneouswindows" class="section level3">
<h3 class="hasAnchor">
<a href="#gethomogeneouswindows" class="anchor"></a>GetHomogeneousWindows</h3>
<div class="sourceCode" id="cb25"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example using a dataframe with 3 windows.</span>

<span class="co">#Windows 20 and 30 are homogeneous if looking at col.two and col.three values.</span>
<span class="va">window.name.column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>

<span class="va">multi.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">window.name.column</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetHomogeneousWindows.html">GetHomogeneousWindows</a></span><span class="op">(</span><span class="va">multi.window.data</span>, <span class="st">"window.name.column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb26"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb26-1"><a href="#cb26-1"></a><span class="co">## [1] 1</span></span>
<span id="cb26-2"><a href="#cb26-2"></a><span class="co">## [1] 2</span></span>
<span id="cb26-3"><a href="#cb26-3"></a><span class="co">## [1] 3</span></span></code></pre></div>
<div class="sourceCode" id="cb27"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#As expected, it looks like two windows are homogeneous.</span>
<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">result</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb28"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb28-1"><a href="#cb28-1"></a><span class="co">## List of 2</span></span>
<span id="cb28-2"><a href="#cb28-2"></a><span class="co">##  $ :'data.frame':    3 obs. of  3 variables:</span></span>
<span id="cb28-3"><a href="#cb28-3"></a><span class="co">##   ..$ window.name.column: num [1:3] 20 20 20</span></span>
<span id="cb28-4"><a href="#cb28-4"></a><span class="co">##   ..$ col.two           : chr [1:3] "a" "a" "a"</span></span>
<span id="cb28-5"><a href="#cb28-5"></a><span class="co">##   ..$ col.three         : num [1:3] 1 1 1</span></span>
<span id="cb28-6"><a href="#cb28-6"></a><span class="co">##  $ :'data.frame':    4 obs. of  3 variables:</span></span>
<span id="cb28-7"><a href="#cb28-7"></a><span class="co">##   ..$ window.name.column: num [1:4] 30 30 30 30</span></span>
<span id="cb28-8"><a href="#cb28-8"></a><span class="co">##   ..$ col.two           : chr [1:4] "a" "a" "a" "a"</span></span>
<span id="cb28-9"><a href="#cb28-9"></a><span class="co">##   ..$ col.three         : num [1:4] 2 2 2 2</span></span></code></pre></div>
<div class="sourceCode" id="cb29"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb30"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb30-1"><a href="#cb30-1"></a><span class="co">##   window.name.column col.two col.three</span></span>
<span id="cb30-2"><a href="#cb30-2"></a><span class="co">## 4                 20       a         1</span></span>
<span id="cb30-3"><a href="#cb30-3"></a><span class="co">## 5                 20       a         1</span></span>
<span id="cb30-4"><a href="#cb30-4"></a><span class="co">## 6                 20       a         1</span></span></code></pre></div>
<div class="sourceCode" id="cb31"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb32"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb32-1"><a href="#cb32-1"></a><span class="co">##    window.name.column col.two col.three</span></span>
<span id="cb32-2"><a href="#cb32-2"></a><span class="co">## 7                  30       a         2</span></span>
<span id="cb32-3"><a href="#cb32-3"></a><span class="co">## 8                  30       a         2</span></span>
<span id="cb32-4"><a href="#cb32-4"></a><span class="co">## 9                  30       a         2</span></span>
<span id="cb32-5"><a href="#cb32-5"></a><span class="co">## 10                 30       a         2</span></span></code></pre></div>
</div>
<div id="getsubsetofwindows" class="section level3">
<h3 class="hasAnchor">
<a href="#getsubsetofwindows" class="anchor"></a>GetSubsetOfWindows()</h3>
<div class="sourceCode" id="cb33"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example using a dataframe with 3 windows.</span>

<span class="co">#Windows 20 and 30 are homogeneous if looking at col.two and col.three values.</span>
<span class="va">window.name.column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">0</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span><span class="op">)</span>

<span class="va">multi.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">window.name.column</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="va">list.of.homogeneous.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetHomogeneousWindows.html">GetHomogeneousWindows</a></span><span class="op">(</span><span class="va">multi.window.data</span>,
<span class="st">"window.name.column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb34"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb34-1"><a href="#cb34-1"></a><span class="co">## [1] 1</span></span>
<span id="cb34-2"><a href="#cb34-2"></a><span class="co">## [1] 2</span></span>
<span id="cb34-3"><a href="#cb34-3"></a><span class="co">## [1] 3</span></span></code></pre></div>
<div class="sourceCode" id="cb35"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Get a subset of windows where col.three has a value of 2</span>
<span class="va">subset.list.of.homogeneous.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetSubsetOfWindows.html">GetSubsetOfWindows</a></span><span class="op">(</span><span class="va">list.of.homogeneous.windows</span>,
<span class="st">"col.three"</span>, <span class="st">"2"</span><span class="op">)</span>

<span class="fu"><a href="https://rdrr.io/r/utils/str.html" class="external-link">str</a></span><span class="op">(</span><span class="va">subset.list.of.homogeneous.windows</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb36"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb36-1"><a href="#cb36-1"></a><span class="co">## List of 1</span></span>
<span id="cb36-2"><a href="#cb36-2"></a><span class="co">##  $ :'data.frame':    4 obs. of  3 variables:</span></span>
<span id="cb36-3"><a href="#cb36-3"></a><span class="co">##   ..$ window.name.column: num [1:4] 30 30 30 30</span></span>
<span id="cb36-4"><a href="#cb36-4"></a><span class="co">##   ..$ col.two           : chr [1:4] "a" "a" "a" "a"</span></span>
<span id="cb36-5"><a href="#cb36-5"></a><span class="co">##   ..$ col.three         : num [1:4] 2 2 2 2</span></span></code></pre></div>
<div class="sourceCode" id="cb37"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">subset.list.of.homogeneous.windows</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb38"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb38-1"><a href="#cb38-1"></a><span class="co">##    window.name.column col.two col.three</span></span>
<span id="cb38-2"><a href="#cb38-2"></a><span class="co">## 7                  30       a         2</span></span>
<span id="cb38-3"><a href="#cb38-3"></a><span class="co">## 8                  30       a         2</span></span>
<span id="cb38-4"><a href="#cb38-4"></a><span class="co">## 9                  30       a         2</span></span>
<span id="cb38-5"><a href="#cb38-5"></a><span class="co">## 10                 30       a         2</span></span></code></pre></div>
</div>
<div id="getsubsetofwindowstwolevels" class="section level3">
<h3 class="hasAnchor">
<a href="#getsubsetofwindowstwolevels" class="anchor"></a>GetSubsetOfWindowsTwoLevels()</h3>
<div class="sourceCode" id="cb39"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Example using a dataframe with 5 homogeneous windows.</span>

<span class="co">#Windows are homogeneous if looking at col.two and col.three values.</span>
<span class="va">window.name.column</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">10</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">20</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">30</span>, <span class="fl">40</span>, <span class="fl">40</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span>, <span class="fl">50</span><span class="op">)</span>
<span class="va">col.two</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"b"</span>, <span class="st">"b"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span>, <span class="st">"a"</span><span class="op">)</span>
<span class="va">col.three</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">2</span>, <span class="fl">1</span>, <span class="fl">1</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span>, <span class="fl">3</span><span class="op">)</span>

<span class="va">multi.window.data</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/data.frame.html" class="external-link">data.frame</a></span><span class="op">(</span><span class="va">window.name.column</span>, <span class="va">col.two</span>, <span class="va">col.three</span><span class="op">)</span>

<span class="va">list.of.homogeneous.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetHomogeneousWindows.html">GetHomogeneousWindows</a></span><span class="op">(</span><span class="va">multi.window.data</span>,
<span class="st">"window.name.column"</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"col.two"</span>, <span class="st">"col.three"</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb40"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb40-1"><a href="#cb40-1"></a><span class="co">## [1] 1</span></span>
<span id="cb40-2"><a href="#cb40-2"></a><span class="co">## [1] 2</span></span>
<span id="cb40-3"><a href="#cb40-3"></a><span class="co">## [1] 3</span></span>
<span id="cb40-4"><a href="#cb40-4"></a><span class="co">## [1] 4</span></span>
<span id="cb40-5"><a href="#cb40-5"></a><span class="co">## [1] 5</span></span></code></pre></div>
<div class="sourceCode" id="cb41"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">result</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/GetSubsetOfWindowsTwoLevels.html">GetSubsetOfWindowsTwoLevels</a></span><span class="op">(</span><span class="va">list.of.homogeneous.windows</span>, <span class="st">"col.two"</span>, <span class="st">"col.three"</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="st">"2"</span><span class="op">)</span><span class="op">)</span>

<span class="co">#Should contain windows 10, 20, 30 because col.two is "a" and col.three can be "1" or "2"</span>
<span class="va">result</span></code></pre></div>
<div class="sourceCode" id="cb42"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb42-1"><a href="#cb42-1"></a><span class="co">## [[1]]</span></span>
<span id="cb42-2"><a href="#cb42-2"></a><span class="co">##   window.name.column col.two col.three</span></span>
<span id="cb42-3"><a href="#cb42-3"></a><span class="co">## 1                 10       a         1</span></span>
<span id="cb42-4"><a href="#cb42-4"></a><span class="co">## 2                 10       a         1</span></span>
<span id="cb42-5"><a href="#cb42-5"></a><span class="co">## 3                 10       a         1</span></span>
<span id="cb42-6"><a href="#cb42-6"></a><span class="co">## </span></span>
<span id="cb42-7"><a href="#cb42-7"></a><span class="co">## [[2]]</span></span>
<span id="cb42-8"><a href="#cb42-8"></a><span class="co">##   window.name.column col.two col.three</span></span>
<span id="cb42-9"><a href="#cb42-9"></a><span class="co">## 4                 20       a         1</span></span>
<span id="cb42-10"><a href="#cb42-10"></a><span class="co">## 5                 20       a         1</span></span>
<span id="cb42-11"><a href="#cb42-11"></a><span class="co">## 6                 20       a         1</span></span>
<span id="cb42-12"><a href="#cb42-12"></a><span class="co">## </span></span>
<span id="cb42-13"><a href="#cb42-13"></a><span class="co">## [[3]]</span></span>
<span id="cb42-14"><a href="#cb42-14"></a><span class="co">##    window.name.column col.two col.three</span></span>
<span id="cb42-15"><a href="#cb42-15"></a><span class="co">## 7                  30       a         2</span></span>
<span id="cb42-16"><a href="#cb42-16"></a><span class="co">## 8                  30       a         2</span></span>
<span id="cb42-17"><a href="#cb42-17"></a><span class="co">## 9                  30       a         2</span></span>
<span id="cb42-18"><a href="#cb42-18"></a><span class="co">## 10                 30       a         2</span></span></code></pre></div>
</div>
<div id="identifymaxonxy" class="section level3">
<h3 class="hasAnchor">
<a href="#identifymaxonxy" class="anchor"></a>IdentifyMaxOnXY()</h3>
<div class="sourceCode" id="cb43"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#I want to create a plot that shows two curves:</span>
<span class="co">#1. Composite of time series signals 1, 2, and 3.</span>
<span class="co">#2. Composite of time series signals 3 and 4.</span>

<span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Extra representation of S2 dataframe to show an example that has enough samples</span>
<span class="co">#to have significance for Kruskal-Wallis test</span>
<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>,
<span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>,
<span class="va">S4.data.frame</span><span class="op">)</span>

<span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co">#Gets the composite of the third and fourth signal</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>


<span class="co">#PSD-------------------------------------------------------------------------</span>

<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">10</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb44"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb44-1"><a href="#cb44-1"></a><span class="co">## [1] 1</span></span>
<span id="cb44-2"><a href="#cb44-2"></a><span class="co">## [1] 2</span></span>
<span id="cb44-3"><a href="#cb44-3"></a><span class="co">## [1] 3</span></span>
<span id="cb44-4"><a href="#cb44-4"></a><span class="co">## [1] 4</span></span>
<span id="cb44-5"><a href="#cb44-5"></a><span class="co">## [1] 5</span></span>
<span id="cb44-6"><a href="#cb44-6"></a><span class="co">## [1] 6</span></span>
<span id="cb44-7"><a href="#cb44-7"></a><span class="co">## [1] 7</span></span>
<span id="cb44-8"><a href="#cb44-8"></a><span class="co">## [1] 8</span></span>
<span id="cb44-9"><a href="#cb44-9"></a><span class="co">## [1] 9</span></span>
<span id="cb44-10"><a href="#cb44-10"></a><span class="co">## [1] 10</span></span>
<span id="cb44-11"><a href="#cb44-11"></a><span class="co">## [1] 11</span></span>
<span id="cb44-12"><a href="#cb44-12"></a><span class="co">## [1] 1</span></span>
<span id="cb44-13"><a href="#cb44-13"></a><span class="co">## [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb45"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot</span>
<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-9-1.png"><!-- --></p>
<div class="sourceCode" id="cb46"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">dataframes.plotted</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">first.curve</span> <span class="op">&lt;-</span> <span class="va">dataframes.plotted</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>
<span class="va">second.curve</span> <span class="op">&lt;-</span> <span class="va">dataframes.plotted</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Identify maximum</span>
<span class="va">first.curve.max</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/IdentifyMaxOnXY.html">IdentifyMaxOnXY</a></span><span class="op">(</span><span class="va">first.curve</span><span class="op">$</span><span class="va">xvals</span>, <span class="va">first.curve</span><span class="op">$</span><span class="va">yvals</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>
<span class="va">second.curve.max</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/IdentifyMaxOnXY.html">IdentifyMaxOnXY</a></span><span class="op">(</span><span class="va">second.curve</span><span class="op">$</span><span class="va">xvals</span>, <span class="va">second.curve</span><span class="op">$</span><span class="va">yvals</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>

<span class="va">first.curve.max</span></code></pre></div>
<div class="sourceCode" id="cb47"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb47-1"><a href="#cb47-1"></a><span class="co">##     xval      yval</span></span>
<span id="cb47-2"><a href="#cb47-2"></a><span class="co">## 101    1 0.0684011</span></span></code></pre></div>
<div class="sourceCode" id="cb48"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">second.curve.max</span></code></pre></div>
<div class="sourceCode" id="cb49"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb49-1"><a href="#cb49-1"></a><span class="co">##     xval       yval</span></span>
<span id="cb49-2"><a href="#cb49-2"></a><span class="co">## 101    1 0.01980033</span></span></code></pre></div>
</div>
<div id="makecompositepsdforallwindows" class="section level3">
<h3 class="hasAnchor">
<a href="#makecompositepsdforallwindows" class="anchor"></a>MakeCompositePSDForAllWindows()</h3>
<div class="sourceCode" id="cb50"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 10 Hz with amplitude of 4</span>
<span class="co">#2. 25 Hz with amplitude of 4</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">25</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="va">S1</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="co">#Add some noise</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 5 Hz with amplitude of 2</span>
<span class="co">#2. 8 Hz with amplitude of 2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">5</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">8</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="va">S2</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="co">#Add some noise</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 5 Hz with amplitude of 2</span>
<span class="co">#2. 8 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">5</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">8</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="va">S3</span> <span class="op">+</span> <span class="fu"><a href="https://rdrr.io/r/stats/Normal.html" class="external-link">rnorm</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">t</span><span class="op">)</span><span class="op">)</span> <span class="co">#Add some noise</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Add all signals to a List</span>
<span class="va">list.of.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span><span class="op">)</span>

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/MakeCompositePSDForAllWindows.html">MakeCompositePSDForAllWindows</a></span><span class="op">(</span><span class="va">list.of.windows</span>, <span class="st">"Signal"</span>, <span class="va">Fs</span>, <span class="fl">0</span>, <span class="fl">30</span>, <span class="fl">0.1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb51"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb51-1"><a href="#cb51-1"></a><span class="co">## [1] 1</span></span>
<span id="cb51-2"><a href="#cb51-2"></a><span class="co">## [1] 2</span></span>
<span id="cb51-3"><a href="#cb51-3"></a><span class="co">## [1] 3</span></span></code></pre></div>
<div class="sourceCode" id="cb52"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">frequencies</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">averaged.PSD</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="va">stddev.PSD</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">frequencies</span>, <span class="va">averaged.PSD</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-10-1.png"><!-- --></p>
</div>
<div id="makecompositexyplotforallwindows" class="section level3">
<h3 class="hasAnchor">
<a href="#makecompositexyplotforallwindows" class="anchor"></a>MakeCompositeXYPlotForAllWindows</h3>
<div class="sourceCode" id="cb53"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 4</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">4</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">2</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span><span class="op">)</span>

<span class="co">#Add all signals to a List</span>
<span class="va">list.of.windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span><span class="op">)</span>

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/MakeCompositeXYPlotForAllWindows.html">MakeCompositeXYPlotForAllWindows</a></span><span class="op">(</span><span class="va">list.of.windows</span>, <span class="st">"Signal"</span>, <span class="fl">0</span>, <span class="fl">999</span>, <span class="fl">1</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb54"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb54-1"><a href="#cb54-1"></a><span class="co">## [1] 1</span></span>
<span id="cb54-2"><a href="#cb54-2"></a><span class="co">## [1] 2</span></span>
<span id="cb54-3"><a href="#cb54-3"></a><span class="co">## [1] 3</span></span></code></pre></div>
<div class="sourceCode" id="cb55"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">x.values</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">y.values</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="va">stddev.y.values</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">3</span><span class="op">]</span><span class="op">]</span>

<span class="co">#plot each xy plot individually</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, ylim <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="op">-</span><span class="fl">5</span>, <span class="fl">5</span><span class="op">)</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, col<span class="op">=</span><span class="st">"blue"</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/lines.html" class="external-link">lines</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, col<span class="op">=</span><span class="st">"green"</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-11-1.png"><!-- --></p>
<div class="sourceCode" id="cb56"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#plot the averaged plot</span>
<span class="co">#The only curve remaining should be the 1Hz with amplitude of 4/3.</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">x.values</span>, <span class="va">y.values</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-11-2.png"><!-- --></p>
</div>
<div id="makeonesidedamplitudespectrum" class="section level3">
<h3 class="hasAnchor">
<a href="#makeonesidedamplitudespectrum" class="anchor"></a>MakeOneSidedAmplitudeSpectrum()</h3>
<div class="sourceCode" id="cb57"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#Form a signal (time series) that contains two frequencies:</span>
<span class="co">#1. 10 Hz with amplitude of 1</span>
<span class="co">#2. 25 Hz with amplitude of 2</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">25</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/MakeOneSidedAmplitudeSpectrum.html">MakeOneSidedAmplitudeSpectrum</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S</span><span class="op">)</span>

<span class="va">frequencies</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">amplitudes</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#dev.new()</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">frequencies</span>, <span class="va">amplitudes</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-12-1.png"><!-- --></p>
</div>
<div id="makepowerspectraldensity" class="section level3">
<h3 class="hasAnchor">
<a href="#makepowerspectraldensity" class="anchor"></a>MakePowerSpectralDensity()</h3>
<div class="sourceCode" id="cb58"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#Form a signal (time series) that contains two frequencies:</span>
<span class="co">#1. 10 Hz with amplitude of 1</span>
<span class="co">#2. 25 Hz with amplitude of 2</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">25</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/MakePowerSpectralDensity.html">MakePowerSpectralDensity</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S</span><span class="op">)</span>

<span class="va">frequencies</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">PSD</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#dev.new()</span>
<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">frequencies</span>, <span class="va">PSD</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-13-1.png"><!-- --></p>
</div>
<div id="psddominantfrequencyformultiplewindows" class="section level3">
<h3 class="hasAnchor">
<a href="#psddominantfrequencyformultiplewindows" class="anchor"></a>PSDDominantFrequencyForMultipleWindows()</h3>
<div class="sourceCode" id="cb59"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>, <span class="va">S4.data.frame</span><span class="op">)</span>

<span class="co">#Plot the PSD for each window</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span>
<span class="va">ThirdComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">FourthComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">5</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span>, 
                                                     <span class="va">ThirdComboToUse</span>, <span class="va">FourthComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1"</span>, <span class="st">"Signal 2"</span>, 
                                                         <span class="st">"Signal 3"</span>, <span class="st">"Signal 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb60"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb60-1"><a href="#cb60-1"></a><span class="co">## [1] 1</span></span>
<span id="cb60-2"><a href="#cb60-2"></a><span class="co">## [1] 1</span></span>
<span id="cb60-3"><a href="#cb60-3"></a><span class="co">## [1] 1</span></span>
<span id="cb60-4"><a href="#cb60-4"></a><span class="co">## [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb61"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot</span>
<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-14-1.png"><!-- --></p>
<div class="sourceCode" id="cb62"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Calculate the dominant frequency for each window</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/PSDDominantFrequencyForMultipleWindows.html">PSDDominantFrequencyForMultipleWindows</a></span><span class="op">(</span><span class="va">windows</span>, <span class="st">"Signal"</span>, <span class="va">Fs</span>, <span class="fl">0</span>, <span class="fl">5</span>, <span class="fl">0.01</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb63"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb63-1"><a href="#cb63-1"></a><span class="co">## [1] 1</span></span>
<span id="cb63-2"><a href="#cb63-2"></a><span class="co">## [1] 2</span></span>
<span id="cb63-3"><a href="#cb63-3"></a><span class="co">## [1] 3</span></span>
<span id="cb63-4"><a href="#cb63-4"></a><span class="co">## [1] 4</span></span></code></pre></div>
<div class="sourceCode" id="cb64"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span></code></pre></div>
<div class="sourceCode" id="cb65"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb65-1"><a href="#cb65-1"></a><span class="co">## [1] 1 1 1 1</span></span></code></pre></div>
</div>
<div id="psdidentifydominantfrequency" class="section level3">
<h3 class="hasAnchor">
<a href="#psdidentifydominantfrequency" class="anchor"></a>PSDIdentifyDominantFrequency()</h3>
<div class="sourceCode" id="cb66"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/PSDIdentifyDominantFrequency.html">PSDIdentifyDominantFrequency</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span>, <span class="fl">0</span>, <span class="fl">10</span>, <span class="fl">0.01</span><span class="op">)</span>

<span class="va">results</span></code></pre></div>
<div class="sourceCode" id="cb67"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb67-1"><a href="#cb67-1"></a><span class="co">##     xval       yval</span></span>
<span id="cb67-2"><a href="#cb67-2"></a><span class="co">## 101    1 0.01977387</span></span></code></pre></div>
</div>
<div id="psdintegrationperfreqbin" class="section level3">
<h3 class="hasAnchor">
<a href="#psdintegrationperfreqbin" class="anchor"></a>PSDIntegrationPerFreqBin()</h3>
<div class="sourceCode" id="cb68"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#Form a signal (time series) that contains two frequencies:</span>
<span class="co">#1. 10 Hz with amplitude of 1</span>
<span class="co">#2. 25 Hz with amplitude of 2</span>
<span class="va">S</span> <span class="op">&lt;-</span> <span class="fl">1</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">10</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">25</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;

<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/MakePowerSpectralDensity.html">MakePowerSpectralDensity</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S</span><span class="op">)</span>

<span class="va">frequencies</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>

<span class="va">PSD</span> <span class="op">&lt;-</span> <span class="va">results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="fu"><a href="https://rdrr.io/r/graphics/plot.default.html" class="external-link">plot</a></span><span class="op">(</span><span class="va">frequencies</span>, <span class="va">PSD</span>, type <span class="op">=</span> <span class="st">"l"</span><span class="op">)</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-16-1.png"><!-- --></p>
<div class="sourceCode" id="cb69"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">bins</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span>
<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>, <span class="fl">11</span><span class="op">)</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">24</span>,<span class="fl">26</span><span class="op">)</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">9</span>,<span class="fl">26</span><span class="op">)</span>,
<span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">30</span>,<span class="fl">40</span><span class="op">)</span>
<span class="op">)</span>

<span class="va">integration.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/PSDIntegrationPerFreqBin.html">PSDIntegrationPerFreqBin</a></span><span class="op">(</span><span class="va">Fs</span>, <span class="va">S</span>, <span class="va">bins</span><span class="op">)</span>

<span class="kw">for</span><span class="op">(</span><span class="va">i</span> <span class="kw">in</span> <span class="fl">1</span><span class="op">:</span><span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">integration.results</span><span class="op">)</span><span class="op">)</span><span class="op">{</span>

   <span class="va">message</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/paste.html" class="external-link">paste</a></span><span class="op">(</span><span class="st">"Area in bin "</span>, <span class="va">integration.results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span>, <span class="st">" is "</span>,
                   <span class="va">integration.results</span><span class="op">[[</span><span class="va">i</span><span class="op">]</span><span class="op">]</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span><span class="op">)</span>

   <span class="fu"><a href="https://rdrr.io/r/base/print.html" class="external-link">print</a></span><span class="op">(</span><span class="va">message</span><span class="op">)</span>

<span class="op">}</span></code></pre></div>
<div class="sourceCode" id="cb70"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb70-1"><a href="#cb70-1"></a><span class="co">## [1] "Area in bin  9 - 11  is  0.000501171241533908"</span></span>
<span id="cb70-2"><a href="#cb70-2"></a><span class="co">## [1] "Area in bin  24 - 26  is  0.00197935842439243"</span></span>
<span id="cb70-3"><a href="#cb70-3"></a><span class="co">## [1] "Area in bin  9 - 26  is  0.00248759865247614"</span></span>
<span id="cb70-4"><a href="#cb70-4"></a><span class="co">## [1] "Area in bin  30 - 40  is  8.00563378584211e-07"</span></span></code></pre></div>
</div>
<div id="singlebinpsdintegrationformultiplewindows" class="section level3">
<h3 class="hasAnchor">
<a href="#singlebinpsdintegrationformultiplewindows" class="anchor"></a>SingleBinPSDIntegrationForMultipleWindows()</h3>
<div class="sourceCode" id="cb71"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>, <span class="va">S4.data.frame</span><span class="op">)</span>

<span class="co">#Plot the PSD for each window</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">2</span><span class="op">)</span> <span class="op">)</span>
<span class="va">ThirdComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">FourthComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>
<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">5</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span>, 
                                                     <span class="va">ThirdComboToUse</span>, <span class="va">FourthComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1"</span>, <span class="st">"Signal 2"</span>, 
                                                         <span class="st">"Signal 3"</span>, <span class="st">"Signal 4"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb72"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb72-1"><a href="#cb72-1"></a><span class="co">## [1] 1</span></span>
<span id="cb72-2"><a href="#cb72-2"></a><span class="co">## [1] 1</span></span>
<span id="cb72-3"><a href="#cb72-3"></a><span class="co">## [1] 1</span></span>
<span id="cb72-4"><a href="#cb72-4"></a><span class="co">## [1] 1</span></span></code></pre></div>
<div class="sourceCode" id="cb73"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="co">#Plot</span>
<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-17-1.png"><!-- --></p>
<div class="sourceCode" id="cb74"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#For each of the 4 windows, calculate the area under the PSD from 0-2 Hz</span>
<span class="va">results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SingleBinPSDIntegrationForMultipleWindows.html">SingleBinPSDIntegrationForMultipleWindows</a></span><span class="op">(</span><span class="va">windows</span>, <span class="st">"Signal"</span>, <span class="va">Fs</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0</span>,<span class="fl">2</span><span class="op">)</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb75"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb75-1"><a href="#cb75-1"></a><span class="co">## [1] 1</span></span>
<span id="cb75-2"><a href="#cb75-2"></a><span class="co">## [1] 2</span></span>
<span id="cb75-3"><a href="#cb75-3"></a><span class="co">## [1] 3</span></span>
<span id="cb75-4"><a href="#cb75-4"></a><span class="co">## [1] 4</span></span></code></pre></div>
<div class="sourceCode" id="cb76"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">results</span></code></pre></div>
<div class="sourceCode" id="cb77"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb77-1"><a href="#cb77-1"></a><span class="co">## [1] 0.001996220 0.009026575 0.003036128 0.001996220</span></span></code></pre></div>
</div>
<div id="singlebinpsdintegrationordominantfreqcomparison" class="section level3">
<h3 class="hasAnchor">
<a href="#singlebinpsdintegrationordominantfreqcomparison" class="anchor"></a>SingleBinPSDIntegrationOrDominantFreqComparison()</h3>
<div class="sourceCode" id="cb78"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Create a vector of time that represent times where data are sampled.</span>
<span class="va">Fs</span> <span class="op">=</span> <span class="fl">100</span>; <span class="co">#sampling frequency in Hz</span>
<span class="cn">T</span> <span class="op">=</span> <span class="fl">1</span><span class="op">/</span><span class="va">Fs</span>; <span class="co">#sampling period</span>
<span class="va">L</span> <span class="op">=</span> <span class="fl">1000</span>; <span class="co">#length of time vector</span>
<span class="va">t</span> <span class="op">=</span> <span class="op">(</span><span class="fl">0</span><span class="op">:</span><span class="va">L</span><span class="op">-</span><span class="fl">1</span><span class="op">)</span><span class="op">*</span><span class="cn">T</span>; <span class="co">#time vector</span>

<span class="co">#First signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="va">S1</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S1</span><span class="op">)</span><span class="op">)</span>
<span class="va">S1.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S1</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S1.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Second signal</span>
<span class="co">#1. 1 Hz with amplitude of -4</span>
<span class="co">#2. 2 Hz with amplitude of -2</span>
<span class="va">S2</span> <span class="op">&lt;-</span> <span class="op">(</span><span class="op">-</span><span class="fl">4</span><span class="op">)</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"2"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S2</span><span class="op">)</span><span class="op">)</span>
<span class="va">S2.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S2</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S2.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Third signal</span>
<span class="co">#1. 1 Hz with amplitude of 2</span>
<span class="co">#2. 2 Hz with amplitude of 2</span>
<span class="va">S3</span> <span class="op">&lt;-</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span> <span class="op">+</span> <span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">2</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>;
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S3</span><span class="op">)</span><span class="op">)</span>
<span class="va">S3.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S3</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S3.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fourth signal</span>
<span class="co">#1. 1 Hz with amplitude of -2</span>
<span class="va">S4</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">1</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"b"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"3"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S4</span><span class="op">)</span><span class="op">)</span>
<span class="va">S4.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S4</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S4.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Fifth signal</span>
<span class="co">#1. 5 Hz with amplitude of -2</span>
<span class="va">S5</span> <span class="op">&lt;-</span> <span class="op">-</span><span class="fl">2</span><span class="op">*</span><span class="fu"><a href="https://rdrr.io/r/base/Trig.html" class="external-link">sin</a></span><span class="op">(</span><span class="fl">2</span><span class="op">*</span><span class="va">pi</span><span class="op">*</span><span class="fl">5</span><span class="op">*</span><span class="va">t</span><span class="op">)</span>
<span class="va">level1.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"c"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S5</span><span class="op">)</span><span class="op">)</span>
<span class="va">level2.vals</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/rep.html" class="external-link">rep</a></span><span class="op">(</span><span class="st">"1"</span>, <span class="fu"><a href="https://rdrr.io/r/base/length.html" class="external-link">length</a></span><span class="op">(</span><span class="va">S5</span><span class="op">)</span><span class="op">)</span>
<span class="va">S5.data.frame</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/as.data.frame.html" class="external-link">as.data.frame</a></span><span class="op">(</span><span class="fu"><a href="https://rdrr.io/r/base/cbind.html" class="external-link">cbind</a></span><span class="op">(</span><span class="va">t</span>, <span class="va">S5</span>, <span class="va">level1.vals</span>, <span class="va">level2.vals</span><span class="op">)</span><span class="op">)</span>
<span class="fu"><a href="https://rdrr.io/r/base/colnames.html" class="external-link">colnames</a></span><span class="op">(</span><span class="va">S5.data.frame</span><span class="op">)</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Time"</span>, <span class="st">"Signal"</span>, <span class="st">"level1.ID"</span>, <span class="st">"level2.ID"</span><span class="op">)</span>
<span class="va">S5.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/numeric.html" class="external-link">as.numeric</a></span><span class="op">(</span><span class="va">S5.data.frame</span><span class="op">[</span>,<span class="st">"Signal"</span><span class="op">]</span><span class="op">)</span>

<span class="co">#Extra representation of S2 dataframe to show an example that has enough samples</span>
<span class="co">#to have significance for Kruskal-Wallis test</span>
<span class="va">windows</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">S1.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>,
<span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S2.data.frame</span>, <span class="va">S3.data.frame</span>,
<span class="va">S4.data.frame</span>,
<span class="va">S5.data.frame</span>, <span class="va">S5.data.frame</span>, <span class="va">S5.data.frame</span>, <span class="va">S5.data.frame</span>, <span class="va">S5.data.frame</span><span class="op">)</span>

<span class="co">#Gets the composite of the first, second, and third signal. Should result in a flat signal.</span>
<span class="va">FirstComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span>, <span class="fl">2</span>, <span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co">#Gets the composite of the third and fourth signal</span>
<span class="va">SecondComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"a"</span>, <span class="st">"b"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">3</span><span class="op">)</span> <span class="op">)</span>

<span class="co">#Gets the composite of fifth signal</span>
<span class="va">ThirdComboToUse</span> <span class="op">&lt;-</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"c"</span><span class="op">)</span>, <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1</span><span class="op">)</span> <span class="op">)</span>


<span class="co">#PSD-------------------------------------------------------------------------</span>

<span class="va">PSD.results</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/AutomatedCompositePlotting.html">AutomatedCompositePlotting</a></span><span class="op">(</span>list.of.windows <span class="op">=</span> <span class="va">windows</span>,
                           name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
                           x_start <span class="op">=</span> <span class="fl">0</span>,
                           x_end <span class="op">=</span> <span class="fl">10</span>,
                           x_increment <span class="op">=</span> <span class="fl">0.01</span>,
                           level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
                           level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
                           level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>,
                                                    <span class="va">SecondComboToUse</span>,
                                                    <span class="va">ThirdComboToUse</span><span class="op">)</span>,
                           level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>,
                                                         <span class="st">"Signal 3 + 4"</span>,
                                                         <span class="st">"Signal 5"</span><span class="op">)</span>,
                           plot.title <span class="op">=</span> <span class="st">"Example"</span>,
                           plot.xlab <span class="op">=</span> <span class="st">"Hz"</span>,
                           plot.ylab <span class="op">=</span> <span class="st">"(Original units)^2/Hz"</span>,
                           combination.index.for.envelope <span class="op">=</span> <span class="fl">2</span>,
                           TimeSeries.PSD.LogPSD <span class="op">=</span> <span class="st">"PSD"</span>,
                           sampling_frequency <span class="op">=</span> <span class="fl">100</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb79"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb79-1"><a href="#cb79-1"></a><span class="co">## [1] 1</span></span>
<span id="cb79-2"><a href="#cb79-2"></a><span class="co">## [1] 2</span></span>
<span id="cb79-3"><a href="#cb79-3"></a><span class="co">## [1] 3</span></span>
<span id="cb79-4"><a href="#cb79-4"></a><span class="co">## [1] 4</span></span>
<span id="cb79-5"><a href="#cb79-5"></a><span class="co">## [1] 5</span></span>
<span id="cb79-6"><a href="#cb79-6"></a><span class="co">## [1] 6</span></span>
<span id="cb79-7"><a href="#cb79-7"></a><span class="co">## [1] 7</span></span>
<span id="cb79-8"><a href="#cb79-8"></a><span class="co">## [1] 8</span></span>
<span id="cb79-9"><a href="#cb79-9"></a><span class="co">## [1] 9</span></span>
<span id="cb79-10"><a href="#cb79-10"></a><span class="co">## [1] 10</span></span>
<span id="cb79-11"><a href="#cb79-11"></a><span class="co">## [1] 11</span></span>
<span id="cb79-12"><a href="#cb79-12"></a><span class="co">## [1] 1</span></span>
<span id="cb79-13"><a href="#cb79-13"></a><span class="co">## [1] 2</span></span>
<span id="cb79-14"><a href="#cb79-14"></a><span class="co">## [1] 1</span></span>
<span id="cb79-15"><a href="#cb79-15"></a><span class="co">## [1] 2</span></span>
<span id="cb79-16"><a href="#cb79-16"></a><span class="co">## [1] 3</span></span>
<span id="cb79-17"><a href="#cb79-17"></a><span class="co">## [1] 4</span></span>
<span id="cb79-18"><a href="#cb79-18"></a><span class="co">## [1] 5</span></span></code></pre></div>
<div class="sourceCode" id="cb80"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="va">ggplot.obj.PSD</span> <span class="op">&lt;-</span> <span class="va">PSD.results</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span>

<span class="va">ggplot.obj.PSD</span></code></pre></div>
<p><img src="README_files/figure-gfm/unnamed-chunk-18-1.png"><!-- --></p>
<div class="sourceCode" id="cb81"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Integration-------------------------------------------------------------------------</span>

<span class="co">#Compare integration for the 1.5-2.5 Hz bin. P-value should not indicate</span>
<span class="co">#significant difference</span>
<span class="va">integration.compare.res</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SingleBinPSDIntegrationOrDominantFreqComparison.html">SingleBinPSDIntegrationOrDominantFreqComparison</a></span><span class="op">(</span>
list.of.windows <span class="op">=</span> <span class="va">windows</span>,
name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
sampling_frequency <span class="op">=</span> <span class="fl">100</span>,
single.bin.boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">1.5</span>, <span class="fl">2.5</span><span class="op">)</span>,
integration.or.dominant.freq <span class="op">=</span> <span class="st">"integration"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb82"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb82-1"><a href="#cb82-1"></a><span class="co">## [1] 1</span></span>
<span id="cb82-2"><a href="#cb82-2"></a><span class="co">## [1] 2</span></span>
<span id="cb82-3"><a href="#cb82-3"></a><span class="co">## [1] 3</span></span>
<span id="cb82-4"><a href="#cb82-4"></a><span class="co">## [1] 4</span></span>
<span id="cb82-5"><a href="#cb82-5"></a><span class="co">## [1] 5</span></span>
<span id="cb82-6"><a href="#cb82-6"></a><span class="co">## [1] 6</span></span>
<span id="cb82-7"><a href="#cb82-7"></a><span class="co">## [1] 7</span></span>
<span id="cb82-8"><a href="#cb82-8"></a><span class="co">## [1] 8</span></span>
<span id="cb82-9"><a href="#cb82-9"></a><span class="co">## [1] 9</span></span>
<span id="cb82-10"><a href="#cb82-10"></a><span class="co">## [1] 10</span></span>
<span id="cb82-11"><a href="#cb82-11"></a><span class="co">## [1] 11</span></span>
<span id="cb82-12"><a href="#cb82-12"></a><span class="co">## [1] 1</span></span>
<span id="cb82-13"><a href="#cb82-13"></a><span class="co">## [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb83"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal-Wallis test results</span>
<span class="va">integration.compare.res</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb84"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb84-1"><a href="#cb84-1"></a><span class="co">## </span></span>
<span id="cb84-2"><a href="#cb84-2"></a><span class="co">##  Kruskal-Wallis rank sum test</span></span>
<span id="cb84-3"><a href="#cb84-3"></a><span class="co">## </span></span>
<span id="cb84-4"><a href="#cb84-4"></a><span class="co">## data:  vals.to.compare.combined by combo.labels.combined</span></span>
<span id="cb84-5"><a href="#cb84-5"></a><span class="co">## Kruskal-Wallis chi-squared = 0, df = 1, p-value = 1</span></span></code></pre></div>
<div class="sourceCode" id="cb85"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Compare integration for the 0.5-1.5 Hz bin. P-value should indicate</span>
<span class="co">#significant difference</span>
<span class="va">integration.compare.res2</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SingleBinPSDIntegrationOrDominantFreqComparison.html">SingleBinPSDIntegrationOrDominantFreqComparison</a></span><span class="op">(</span>
list.of.windows <span class="op">=</span> <span class="va">windows</span>,
name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
sampling_frequency <span class="op">=</span> <span class="fl">100</span>,
single.bin.boundary <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>,<span class="fl">1.5</span><span class="op">)</span>,
integration.or.dominant.freq <span class="op">=</span> <span class="st">"integration"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb86"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb86-1"><a href="#cb86-1"></a><span class="co">## [1] 1</span></span>
<span id="cb86-2"><a href="#cb86-2"></a><span class="co">## [1] 2</span></span>
<span id="cb86-3"><a href="#cb86-3"></a><span class="co">## [1] 3</span></span>
<span id="cb86-4"><a href="#cb86-4"></a><span class="co">## [1] 4</span></span>
<span id="cb86-5"><a href="#cb86-5"></a><span class="co">## [1] 5</span></span>
<span id="cb86-6"><a href="#cb86-6"></a><span class="co">## [1] 6</span></span>
<span id="cb86-7"><a href="#cb86-7"></a><span class="co">## [1] 7</span></span>
<span id="cb86-8"><a href="#cb86-8"></a><span class="co">## [1] 8</span></span>
<span id="cb86-9"><a href="#cb86-9"></a><span class="co">## [1] 9</span></span>
<span id="cb86-10"><a href="#cb86-10"></a><span class="co">## [1] 10</span></span>
<span id="cb86-11"><a href="#cb86-11"></a><span class="co">## [1] 11</span></span>
<span id="cb86-12"><a href="#cb86-12"></a><span class="co">## [1] 1</span></span>
<span id="cb86-13"><a href="#cb86-13"></a><span class="co">## [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb87"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal-Wallis test results</span>
<span class="va">integration.compare.res2</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb88"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb88-1"><a href="#cb88-1"></a><span class="co">## </span></span>
<span id="cb88-2"><a href="#cb88-2"></a><span class="co">##  Kruskal-Wallis rank sum test</span></span>
<span id="cb88-3"><a href="#cb88-3"></a><span class="co">## </span></span>
<span id="cb88-4"><a href="#cb88-4"></a><span class="co">## data:  vals.to.compare.combined by combo.labels.combined</span></span>
<span id="cb88-5"><a href="#cb88-5"></a><span class="co">## Kruskal-Wallis chi-squared = 4.7468, df = 1, p-value = 0.02935</span></span></code></pre></div>
<div class="sourceCode" id="cb89"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Dominant Frequency---------------------------------------------------------------------</span>

<span class="co">#Compare dominant frequency P-value should not indicate</span>
<span class="co">#significant difference</span>
<span class="va">integration.compare.res3</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SingleBinPSDIntegrationOrDominantFreqComparison.html">SingleBinPSDIntegrationOrDominantFreqComparison</a></span><span class="op">(</span>
list.of.windows <span class="op">=</span> <span class="va">windows</span>,
name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">FirstComboToUse</span>, <span class="va">SecondComboToUse</span><span class="op">)</span>,
level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 1 + 2 + 3"</span>, <span class="st">"Signal 3 + 4"</span><span class="op">)</span>,
sampling_frequency <span class="op">=</span> <span class="fl">100</span>,
x_start <span class="op">=</span> <span class="fl">0</span>,
x_end <span class="op">=</span> <span class="fl">10</span>,
x_increment <span class="op">=</span> <span class="fl">0.01</span>,
integration.or.dominant.freq <span class="op">=</span> <span class="st">"dominant_freq"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb90"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb90-1"><a href="#cb90-1"></a><span class="co">## [1] 1</span></span>
<span id="cb90-2"><a href="#cb90-2"></a><span class="co">## [1] 2</span></span>
<span id="cb90-3"><a href="#cb90-3"></a><span class="co">## [1] 3</span></span>
<span id="cb90-4"><a href="#cb90-4"></a><span class="co">## [1] 4</span></span>
<span id="cb90-5"><a href="#cb90-5"></a><span class="co">## [1] 5</span></span>
<span id="cb90-6"><a href="#cb90-6"></a><span class="co">## [1] 6</span></span>
<span id="cb90-7"><a href="#cb90-7"></a><span class="co">## [1] 7</span></span>
<span id="cb90-8"><a href="#cb90-8"></a><span class="co">## [1] 8</span></span>
<span id="cb90-9"><a href="#cb90-9"></a><span class="co">## [1] 9</span></span>
<span id="cb90-10"><a href="#cb90-10"></a><span class="co">## [1] 10</span></span>
<span id="cb90-11"><a href="#cb90-11"></a><span class="co">## [1] 11</span></span>
<span id="cb90-12"><a href="#cb90-12"></a><span class="co">## [1] 1</span></span>
<span id="cb90-13"><a href="#cb90-13"></a><span class="co">## [1] 2</span></span></code></pre></div>
<div class="sourceCode" id="cb91"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal-Wallis test results</span>
<span class="va">integration.compare.res3</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb92"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb92-1"><a href="#cb92-1"></a><span class="co">## </span></span>
<span id="cb92-2"><a href="#cb92-2"></a><span class="co">##  Kruskal-Wallis rank sum test</span></span>
<span id="cb92-3"><a href="#cb92-3"></a><span class="co">## </span></span>
<span id="cb92-4"><a href="#cb92-4"></a><span class="co">## data:  vals.to.compare.combined by combo.labels.combined</span></span>
<span id="cb92-5"><a href="#cb92-5"></a><span class="co">## Kruskal-Wallis chi-squared = NaN, df = 1, p-value = NA</span></span></code></pre></div>
<div class="sourceCode" id="cb93"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Compare dominant frequency P-value should indicate</span>
<span class="co">#significant difference</span>
<span class="va">integration.compare.res4</span> <span class="op">&lt;-</span> <span class="fu"><a href="reference/SingleBinPSDIntegrationOrDominantFreqComparison.html">SingleBinPSDIntegrationOrDominantFreqComparison</a></span><span class="op">(</span>
list.of.windows <span class="op">=</span> <span class="va">windows</span>,
name.of.col.containing.time.series <span class="op">=</span> <span class="st">"Signal"</span>,
level1.column.name <span class="op">=</span> <span class="st">"level1.ID"</span>,
level2.column.name <span class="op">=</span> <span class="st">"level2.ID"</span>,
level.combinations <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/list.html" class="external-link">list</a></span><span class="op">(</span><span class="va">SecondComboToUse</span>, <span class="va">ThirdComboToUse</span><span class="op">)</span>,
level.combinations.labels <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="st">"Signal 3 + 4"</span>, <span class="st">"Signal 5"</span><span class="op">)</span>,
sampling_frequency <span class="op">=</span> <span class="fl">100</span>,
x_start <span class="op">=</span> <span class="fl">0</span>,
x_end <span class="op">=</span> <span class="fl">10</span>,
x_increment <span class="op">=</span> <span class="fl">0.01</span>,
integration.or.dominant.freq <span class="op">=</span> <span class="st">"dominant_freq"</span><span class="op">)</span></code></pre></div>
<div class="sourceCode" id="cb94"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb94-1"><a href="#cb94-1"></a><span class="co">## [1] 1</span></span>
<span id="cb94-2"><a href="#cb94-2"></a><span class="co">## [1] 2</span></span>
<span id="cb94-3"><a href="#cb94-3"></a><span class="co">## [1] 1</span></span>
<span id="cb94-4"><a href="#cb94-4"></a><span class="co">## [1] 2</span></span>
<span id="cb94-5"><a href="#cb94-5"></a><span class="co">## [1] 3</span></span>
<span id="cb94-6"><a href="#cb94-6"></a><span class="co">## [1] 4</span></span>
<span id="cb94-7"><a href="#cb94-7"></a><span class="co">## [1] 5</span></span></code></pre></div>
<div class="sourceCode" id="cb95"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Kruskal-Wallis test results</span>
<span class="va">integration.compare.res4</span><span class="op">[[</span><span class="fl">2</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb96"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb96-1"><a href="#cb96-1"></a><span class="co">## </span></span>
<span id="cb96-2"><a href="#cb96-2"></a><span class="co">##  Kruskal-Wallis rank sum test</span></span>
<span id="cb96-3"><a href="#cb96-3"></a><span class="co">## </span></span>
<span id="cb96-4"><a href="#cb96-4"></a><span class="co">## data:  vals.to.compare.combined by combo.labels.combined</span></span>
<span id="cb96-5"><a href="#cb96-5"></a><span class="co">## Kruskal-Wallis chi-squared = 6, df = 1, p-value = 0.01431</span></span></code></pre></div>
<div class="sourceCode" id="cb97"><pre class="downlit sourceCode r">
<code class="sourceCode R"><span class="co">#Values used in Kruskal-Wallis test</span>
<span class="va">integration.compare.res4</span><span class="op">[[</span><span class="fl">1</span><span class="op">]</span><span class="op">]</span></code></pre></div>
<div class="sourceCode" id="cb98"><pre class="sourceCode R"><code class="sourceCode r"><span id="cb98-1"><a href="#cb98-1"></a><span class="co">##              vals.to.compare.combined</span></span>
<span id="cb98-2"><a href="#cb98-2"></a><span class="co">## Signal 3 + 4                        1</span></span>
<span id="cb98-3"><a href="#cb98-3"></a><span class="co">## Signal 3 + 4                        1</span></span>
<span id="cb98-4"><a href="#cb98-4"></a><span class="co">## Signal 5                            5</span></span>
<span id="cb98-5"><a href="#cb98-5"></a><span class="co">## Signal 5                            5</span></span>
<span id="cb98-6"><a href="#cb98-6"></a><span class="co">## Signal 5                            5</span></span>
<span id="cb98-7"><a href="#cb98-7"></a><span class="co">## Signal 5                            5</span></span>
<span id="cb98-8"><a href="#cb98-8"></a><span class="co">## Signal 5                            5</span></span></code></pre></div>
</div>
</div>

  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <div class="license">
<h2 data-toc-skip>License</h2>
<ul class="list-unstyled">
<li><a href="LICENSE.html">Full license</a></li>
<li><small><a href="https://opensource.org/licenses/mit-license.php">MIT</a> + file <a href="LICENSE-text.html">LICENSE</a></small></li>
</ul>
</div>


<div class="developers">
<h2 data-toc-skip>Developers</h2>
<ul class="list-unstyled">
<li>Yong-Han Hank Cheng <br><small class="roles"> Author, maintainer </small> <a href="https://orcid.org/0000-0001-7686-0697" target="orcid.widget" aria-label="ORCID"><span class="fab fa-orcid orcid" aria-hidden="true"></span></a> </li>
</ul>
</div>



  </div>
</div>


      <footer><div class="copyright">
  <p></p>
<p>Developed by Yong-Han Hank Cheng.</p>
</div>

<div class="pkgdown">
  <p></p>
<p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 1.6.1.9001.</p>
</div>

      </footer>
</div>

  


  

  </body>
</html>
